<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CETæˆç»©æ™ºèƒ½è¯„ä¼°ç³»ç»Ÿ | ç²¾å‡†å®šä½ä½ çš„è‹±è¯­æ°´å¹³</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600;700;900&family=JetBrains+Mono:wght@400;600&family=Noto+Sans+SC:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
    <style>
        :root {
            --primary: #1a1a2e;
            --secondary: #16213e;
            --accent: #0f3460;
            --highlight: #e94560;
            --success: #00d9ff;
            --warning: #ffa500;
            --light: #f5f5f5;
            --text: #2d3436;
            --border: #dfe6e9;
            --shadow: rgba(0, 0, 0, 0.1);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Noto Sans SC', sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: var(--text);
            line-height: 1.6;
            min-height: 100vh;
        }

        .hero {
            background: linear-gradient(135deg, rgba(26, 26, 46, 0.95), rgba(22, 33, 62, 0.95));
            color: white;
            padding: 60px 20px;
            text-align: center;
            border-bottom: 4px solid var(--highlight);
            position: relative;
            overflow: hidden;
        }

        .hero::before {
            content: '';
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 1200 120"><path d="M0,0 Q300,50 600,20 T1200,0 L1200,120 L0,120 Z" fill="rgba(233,69,96,0.1)"/></svg>') bottom/cover no-repeat;
            opacity: 0.3;
        }

        .hero h1 {
            font-family: 'Noto Serif SC', serif;
            font-size: 3em;
            font-weight: 900;
            margin-bottom: 15px;
            position: relative;
            z-index: 1;
            text-shadow: 2px 2px 4px rgba(0,0,0,0.3);
        }

        .hero .subtitle {
            font-size: 1.2em;
            opacity: 0.9;
            font-weight: 300;
            position: relative;
            z-index: 1;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 40px 20px;
        }

        .mode-selector {
            display: flex;
            justify-content: center;
            gap: 20px;
            margin-bottom: 40px;
        }

        .mode-btn {
            padding: 15px 40px;
            font-size: 1.1em;
            font-weight: 600;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Noto Sans SC', sans-serif;
        }

        .mode-btn.active {
            background: linear-gradient(135deg, var(--highlight), #ff6b9d);
            color: white;
            transform: translateY(-3px);
            box-shadow: 0 8px 20px rgba(233, 69, 96, 0.4);
        }

        .mode-btn:not(.active) {
            background: white;
            color: var(--primary);
            border: 2px solid var(--border);
        }

        .mode-btn:not(.active):hover {
            border-color: var(--highlight);
            transform: translateY(-2px);
        }

        .input-section {
            background: white;
            padding: 40px;
            border-radius: 16px;
            box-shadow: 0 10px 40px var(--shadow);
            margin-bottom: 30px;
        }

        .section-title {
            font-family: 'Noto Serif SC', serif;
            font-size: 1.8em;
            font-weight: 700;
            color: var(--primary);
            margin-bottom: 25px;
            padding-bottom: 15px;
            border-bottom: 3px solid var(--highlight);
        }

        .form-group {
            margin-bottom: 25px;
        }

        .form-group label {
            display: block;
            font-weight: 600;
            margin-bottom: 10px;
            color: var(--primary);
            font-size: 1.05em;
        }

        .form-group input,
        .form-group select {
            width: 100%;
            padding: 15px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1em;
            font-family: 'Noto Sans SC', sans-serif;
            transition: border 0.3s ease;
        }

        .form-group input:focus,
        .form-group select:focus {
            outline: none;
            border-color: var(--highlight);
        }

        .score-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-top: 20px;
        }

        .score-input {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid var(--border);
            transition: all 0.3s ease;
        }

        .score-input:hover {
            border-color: var(--highlight);
            transform: translateY(-2px);
        }

        .score-input label {
            display: block;
            font-weight: 600;
            margin-bottom: 8px;
            color: var(--primary);
        }

        .score-input input {
            width: 100%;
            padding: 12px;
            border: 2px solid var(--border);
            border-radius: 8px;
            font-size: 1.1em;
            font-family: 'JetBrains Mono', monospace;
            text-align: center;
            font-weight: 600;
        }

        .score-hint {
            font-size: 0.85em;
            color: #666;
            margin-top: 5px;
        }

        .analyze-btn {
            background: linear-gradient(135deg, var(--highlight), #ff6b9d);
            color: white;
            border: none;
            padding: 18px 50px;
            font-size: 1.2em;
            font-weight: 700;
            border-radius: 30px;
            cursor: pointer;
            transition: all 0.3s ease;
            box-shadow: 0 8px 20px rgba(233, 69, 96, 0.3);
            font-family: 'Noto Sans SC', sans-serif;
            display: block;
            margin: 30px auto 0;
        }

        .analyze-btn:hover {
            transform: translateY(-3px);
            box-shadow: 0 12px 28px rgba(233, 69, 96, 0.4);
        }

        .analyze-btn:active {
            transform: translateY(-1px);
        }

        .results {
            display: none;
        }

        .results.show {
            display: block;
            animation: fadeInUp 0.6s ease;
        }

        @keyframes fadeInUp {
            from {
                opacity: 0;
                transform: translateY(30px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .result-card {
            background: white;
            padding: 30px;
            border-radius: 16px;
            box-shadow: 0 10px 40px var(--shadow);
            margin-bottom: 25px;
        }

        .percentile-display {
            text-align: center;
            padding: 40px;
            background: linear-gradient(135deg, #667eea, #764ba2);
            border-radius: 16px;
            color: white;
            margin-bottom: 30px;
        }

        .percentile-number {
            font-size: 5em;
            font-weight: 900;
            font-family: 'JetBrains Mono', monospace;
            line-height: 1;
            margin: 20px 0;
            text-shadow: 2px 2px 8px rgba(0,0,0,0.3);
        }

        .percentile-label {
            font-size: 1.5em;
            opacity: 0.9;
        }

        .level-badge {
            display: inline-block;
            padding: 10px 25px;
            border-radius: 25px;
            font-weight: 700;
            font-size: 1.3em;
            margin: 15px 0;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        .level-badge.legendary {
            background: linear-gradient(135deg, #ffd700, #ffed4e);
            color: #8b4513;
            box-shadow: 0 4px 15px rgba(255, 215, 0, 0.4);
        }

        .level-badge.diamond {
            background: linear-gradient(135deg, #00d9ff, #7dd3fc);
            color: #003d4d;
            box-shadow: 0 4px 15px rgba(0, 217, 255, 0.4);
        }

        .level-badge.platinum {
            background: linear-gradient(135deg, #9c27b0, #ba68c8);
            color: white;
            box-shadow: 0 4px 15px rgba(156, 39, 176, 0.4);
        }

        .level-badge.gold {
            background: linear-gradient(135deg, #ff9800, #ffc947);
            color: white;
            box-shadow: 0 4px 15px rgba(255, 152, 0, 0.4);
        }

        .level-badge.silver {
            background: linear-gradient(135deg, #9e9e9e, #bdbdbd);
            color: white;
            box-shadow: 0 4px 15px rgba(158, 158, 158, 0.4);
        }

        .level-badge.bronze {
            background: linear-gradient(135deg, #795548, #a1887f);
            color: white;
            box-shadow: 0 4px 15px rgba(121, 85, 72, 0.4);
        }

        .comparison-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .comparison-card {
            background: linear-gradient(135deg, var(--primary), var(--accent));
            color: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 8px 24px rgba(0, 0, 0, 0.15);
        }

        .comparison-card h3 {
            font-size: 1.1em;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .comparison-card .score {
            font-size: 2.5em;
            font-weight: 700;
            font-family: 'JetBrains Mono', monospace;
        }

        .comparison-card .desc {
            font-size: 0.9em;
            opacity: 0.8;
            margin-top: 10px;
        }

        .radar-container {
            max-width: 600px;
            margin: 30px auto;
            padding: 20px;
            background: #fafafa;
            border-radius: 12px;
        }

        .strength-weakness {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 25px;
            margin: 25px 0;
        }

        .strength-box,
        .weakness-box {
            padding: 25px;
            border-radius: 12px;
        }

        .strength-box {
            background: linear-gradient(135deg, #e8f5e9, #c8e6c9);
            border-left: 5px solid #4caf50;
        }

        .weakness-box {
            background: linear-gradient(135deg, #fff3e0, #ffe0b2);
            border-left: 5px solid #ff9800;
        }

        .strength-box h3,
        .weakness-box h3 {
            margin-bottom: 15px;
            font-size: 1.3em;
        }

        .strength-box ul,
        .weakness-box ul {
            list-style: none;
            padding: 0;
        }

        .strength-box li,
        .weakness-box li {
            padding: 8px 0;
            padding-left: 25px;
            position: relative;
        }

        .strength-box li::before {
            content: 'âœ“';
            position: absolute;
            left: 0;
            color: #4caf50;
            font-weight: bold;
            font-size: 1.2em;
        }

        .weakness-box li::before {
            content: 'âš ';
            position: absolute;
            left: 0;
            color: #ff9800;
            font-size: 1.2em;
        }

        .suggestions {
            background: linear-gradient(135deg, #e3f2fd, #bbdefb);
            padding: 30px;
            border-radius: 12px;
            border-left: 5px solid #2196f3;
            margin: 25px 0;
        }

        .suggestions h3 {
            color: var(--primary);
            margin-bottom: 20px;
            font-size: 1.4em;
        }

        .suggestion-item {
            background: white;
            padding: 20px;
            border-radius: 8px;
            margin-bottom: 15px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .suggestion-item h4 {
            color: var(--highlight);
            margin-bottom: 10px;
            font-size: 1.1em;
        }

        .suggestion-item p {
            color: #666;
            line-height: 1.8;
        }

        .percentile-bar {
            height: 60px;
            background: linear-gradient(to right, 
                #ef5350 0%, 
                #ff9800 20%, 
                #ffc107 40%, 
                #66bb6a 60%, 
                #42a5f5 80%, 
                #ab47bc 100%);
            border-radius: 30px;
            position: relative;
            margin: 30px 0;
            box-shadow: 0 4px 12px rgba(0,0,0,0.2);
        }

        .percentile-marker {
            position: absolute;
            top: -50px;
            transform: translateX(-50%);
            text-align: center;
        }

        .percentile-marker .arrow {
            width: 0;
            height: 0;
            border-left: 15px solid transparent;
            border-right: 15px solid transparent;
            border-top: 25px solid var(--primary);
            margin: 0 auto 5px;
            animation: bounce 1.5s infinite;
        }

        @keyframes bounce {
            0%, 100% { transform: translateY(0); }
            50% { transform: translateY(-10px); }
        }

        .percentile-marker .label {
            background: var(--primary);
            color: white;
            padding: 10px 20px;
            border-radius: 25px;
            font-weight: 700;
            font-size: 1em;
            white-space: nowrap;
            box-shadow: 0 4px 12px rgba(0,0,0,0.3);
        }

        .info-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin: 25px 0;
        }

        .info-item {
            background: white;
            padding: 20px;
            border-radius: 12px;
            border: 2px solid var(--border);
            text-align: center;
        }

        .info-item .icon {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .info-item .value {
            font-size: 2em;
            font-weight: 700;
            color: var(--highlight);
            font-family: 'JetBrains Mono', monospace;
            margin: 10px 0;
        }

        .info-item .label {
            color: #666;
            font-size: 0.95em;
        }

        @media (max-width: 768px) {
            .hero h1 {
                font-size: 2em;
            }
            
            .mode-selector {
                flex-direction: column;
                gap: 10px;
            }
            
            .strength-weakness {
                grid-template-columns: 1fr;
            }
            
            .percentile-number {
                font-size: 3.5em;
            }
        }

        .hidden {
            display: none !important;
        }

        .score-distribution {
            margin: 30px 0;
        }

        .distribution-bar {
            display: flex;
            align-items: center;
            margin: 15px 0;
            gap: 15px;
        }

        .distribution-label {
            width: 100px;
            font-weight: 600;
            color: var(--primary);
        }

        .distribution-fill-container {
            flex: 1;
            height: 35px;
            background: #e0e0e0;
            border-radius: 20px;
            overflow: hidden;
            position: relative;
        }

        .distribution-fill {
            height: 100%;
            background: linear-gradient(90deg, var(--highlight), var(--success));
            border-radius: 20px;
            display: flex;
            align-items: center;
            justify-content: flex-end;
            padding-right: 15px;
            color: white;
            font-weight: 600;
            font-size: 0.9em;
            transition: width 1s ease;
        }

        .reset-btn {
            background: #6c757d;
            color: white;
            border: none;
            padding: 12px 30px;
            font-size: 1em;
            font-weight: 600;
            border-radius: 25px;
            cursor: pointer;
            transition: all 0.3s ease;
            font-family: 'Noto Sans SC', sans-serif;
            margin-left: 15px;
        }

        .reset-btn:hover {
            background: #5a6268;
            transform: translateY(-2px);
        }
    </style>
</head>
<body>
    <div class="hero">
        <h1>CETæˆç»©æ™ºèƒ½è¯„ä¼°ç³»ç»Ÿ</h1>
        <p class="subtitle">ç²¾å‡†å®šä½ä½ çš„è‹±è¯­æ°´å¹³ | ä¸ªæ€§åŒ–èƒ½åŠ›åˆ†æ | ä¸“ä¸šå­¦ä¹ å»ºè®®</p>
    </div>

    <div class="container">
        <!-- æ¨¡å¼é€‰æ‹© -->
        <div class="mode-selector">
            <button class="mode-btn active" onclick="switchMode('quick')">
                ğŸš€ å¿«é€Ÿè¯„ä¼°
            </button>
            <button class="mode-btn" onclick="switchMode('detailed')">
                ğŸ“Š è¯¦ç»†åˆ†æ
            </button>
        </div>

        <!-- å¿«é€Ÿè¯„ä¼°æ¨¡å¼ -->
        <div id="quickMode" class="input-section">
            <h2 class="section-title">å¿«é€Ÿè¯„ä¼° - è¾“å…¥æ€»åˆ†</h2>
            
            <div class="form-group">
                <label for="examType">é€‰æ‹©è€ƒè¯•ç±»å‹</label>
                <select id="examType" onchange="updateScoreHints()">
                    <option value="cet4">CET-4ï¼ˆå¤§å­¦è‹±è¯­å››çº§ï¼‰</option>
                    <option value="cet6">CET-6ï¼ˆå¤§å­¦è‹±è¯­å…­çº§ï¼‰</option>
                </select>
            </div>

            <div class="form-group">
                <label for="totalScore">ä½ çš„æ€»åˆ†</label>
                <input type="number" id="totalScore" placeholder="è¯·è¾“å…¥æ€»åˆ†ï¼ˆ220-710åˆ†ï¼‰" 
                       min="220" max="710" step="1">
                <div class="score-hint">æ»¡åˆ†710åˆ†ï¼ŒåŠæ ¼çº¿425åˆ†</div>
            </div>

            <button class="analyze-btn" onclick="analyzeQuick()">
                ğŸ¯ å¼€å§‹è¯„ä¼°
            </button>
        </div>

        <!-- è¯¦ç»†åˆ†ææ¨¡å¼ -->
        <div id="detailedMode" class="input-section hidden">
            <h2 class="section-title">è¯¦ç»†åˆ†æ - è¾“å…¥å„é¡¹æˆç»©</h2>
            
            <div class="form-group">
                <label for="examTypeDetailed">é€‰æ‹©è€ƒè¯•ç±»å‹</label>
                <select id="examTypeDetailed" onchange="updateDetailedHints()">
                    <option value="cet4">CET-4ï¼ˆå¤§å­¦è‹±è¯­å››çº§ï¼‰</option>
                    <option value="cet6">CET-6ï¼ˆå¤§å­¦è‹±è¯­å…­çº§ï¼‰</option>
                </select>
            </div>

            <div class="score-grid">
                <div class="score-input">
                    <label for="listeningScore">å¬åŠ›</label>
                    <input type="number" id="listeningScore" placeholder="0-249" 
                           min="0" max="249" step="0.5">
                    <div class="score-hint">æ»¡åˆ†249åˆ†</div>
                </div>

                <div class="score-input">
                    <label for="readingScore">é˜…è¯»</label>
                    <input type="number" id="readingScore" placeholder="0-249" 
                           min="0" max="249" step="0.5">
                    <div class="score-hint">æ»¡åˆ†249åˆ†</div>
                </div>

                <div class="score-input">
                    <label for="writingScore">å†™ä½œä¸ç¿»è¯‘</label>
                    <input type="number" id="writingScore" placeholder="0-212" 
                           min="0" max="212" step="0.5">
                    <div class="score-hint">æ»¡åˆ†212åˆ†</div>
                </div>
            </div>

            <button class="analyze-btn" onclick="analyzeDetailed()">
                ğŸ” æ·±åº¦åˆ†æ
            </button>
        </div>

        <!-- ç»“æœå±•ç¤ºåŒºåŸŸ -->
        <div id="results" class="results">
            <!-- ç™¾åˆ†ä½å±•ç¤º -->
            <div class="result-card percentile-display">
                <div class="percentile-label">ä½ è¶…è¶Šäº†å…¨å›½</div>
                <div class="percentile-number" id="percentileValue">0%</div>
                <div class="percentile-label">çš„å¤§å­¦ç”Ÿ</div>
                <div class="level-badge" id="levelBadge">è¯„ä¼°ä¸­...</div>
            </div>

            <!-- ç™¾åˆ†ä½å¯è§†åŒ– -->
            <div class="result-card">
                <h2 class="section-title">ä½ åœ¨èƒ½åŠ›å¤©æ¢¯ä¸­çš„ä½ç½®</h2>
                <div class="percentile-bar">
                    <div class="percentile-marker" id="markerPosition">
                        <div class="label">ä½ çš„ä½ç½®</div>
                        <div class="arrow"></div>
                    </div>
                </div>
                <div style="display:flex; justify-content:space-between; margin-top:20px; font-size:0.9em; color:#666;">
                    <span>0% (æœ€ä½)</span>
                    <span>25%</span>
                    <span>50% (ä¸­ä½æ•°)</span>
                    <span>75%</span>
                    <span>100% (æœ€é«˜)</span>
                </div>
            </div>

            <!-- å›½é™…å¯¹æ ‡ -->
            <div class="result-card">
                <h2 class="section-title">ä¸ä¸»æµè€ƒè¯•å¯¹æ ‡</h2>
                <div class="comparison-grid" id="comparisonGrid">
                    <!-- åŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>

            <!-- åŸºæœ¬ä¿¡æ¯ -->
            <div class="result-card">
                <h2 class="section-title">èƒ½åŠ›æ¦‚è§ˆ</h2>
                <div class="info-grid" id="infoGrid">
                    <!-- åŠ¨æ€ç”Ÿæˆ -->
                </div>
            </div>

            <!-- è¯¦ç»†åˆ†æï¼ˆä»…è¯¦ç»†æ¨¡å¼æ˜¾ç¤ºï¼‰ -->
            <div id="detailedResults" class="hidden">
                <!-- é›·è¾¾å›¾ -->
                <div class="result-card">
                    <h2 class="section-title">èƒ½åŠ›é›·è¾¾å›¾</h2>
                    <div class="radar-container">
                        <canvas id="radarChart"></canvas>
                    </div>
                </div>

                <!-- å•ç§‘åˆ†å¸ƒ -->
                <div class="result-card">
                    <h2 class="section-title">å•ç§‘æˆç»©åˆ†å¸ƒ</h2>
                    <div class="score-distribution" id="scoreDistribution">
                        <!-- åŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>

                <!-- ä¼˜åŠ¿ä¸åŠ£åŠ¿ -->
                <div class="result-card">
                    <h2 class="section-title">ä¼˜åŠ¿ä¸åŠ£åŠ¿åˆ†æ</h2>
                    <div class="strength-weakness">
                        <div class="strength-box">
                            <h3>ğŸ’ª ä½ çš„ä¼˜åŠ¿</h3>
                            <ul id="strengthList">
                                <!-- åŠ¨æ€ç”Ÿæˆ -->
                            </ul>
                        </div>
                        <div class="weakness-box">
                            <h3>ğŸ“ˆ æå‡ç©ºé—´</h3>
                            <ul id="weaknessList">
                                <!-- åŠ¨æ€ç”Ÿæˆ -->
                            </ul>
                        </div>
                    </div>
                </div>

                <!-- ä¸ªæ€§åŒ–å»ºè®® -->
                <div class="suggestions">
                    <h3>ğŸ¯ é’ˆå¯¹æ€§å­¦ä¹ å»ºè®®</h3>
                    <div id="suggestionsList">
                        <!-- åŠ¨æ€ç”Ÿæˆ -->
                    </div>
                </div>
            </div>

            <!-- é‡æ–°è¯„ä¼°æŒ‰é’® -->
            <div style="text-align: center; margin-top: 30px;">
                <button class="analyze-btn" onclick="resetForm()">
                    ğŸ”„ é‡æ–°è¯„ä¼°
                </button>
            </div>
        </div>
    </div>

    <script>
        let currentMode = 'quick';
        let radarChartInstance = null;

        function switchMode(mode) {
            currentMode = mode;
            const quickBtn = document.querySelector('.mode-btn:nth-child(1)');
            const detailedBtn = document.querySelector('.mode-btn:nth-child(2)');
            const quickMode = document.getElementById('quickMode');
            const detailedMode = document.getElementById('detailedMode');

            if (mode === 'quick') {
                quickBtn.classList.add('active');
                detailedBtn.classList.remove('active');
                quickMode.classList.remove('hidden');
                detailedMode.classList.add('hidden');
            } else {
                quickBtn.classList.remove('active');
                detailedBtn.classList.add('active');
                quickMode.classList.add('hidden');
                detailedMode.classList.remove('hidden');
            }

            // éšè—ç»“æœ
            document.getElementById('results').classList.remove('show');
        }

        function updateScoreHints() {
            // å¯ä»¥æ ¹æ®ä¸åŒè€ƒè¯•ç±»å‹æ›´æ–°æç¤º
        }

        function updateDetailedHints() {
            // å¯ä»¥æ ¹æ®ä¸åŒè€ƒè¯•ç±»å‹æ›´æ–°æç¤º
        }

        function analyzeQuick() {
            const examType = document.getElementById('examType').value;
            const totalScore = parseFloat(document.getElementById('totalScore').value);

            if (!totalScore || totalScore < 220 || totalScore > 710) {
                alert('è¯·è¾“å…¥æœ‰æ•ˆçš„åˆ†æ•°ï¼ˆ220-710åˆ†ï¼‰');
                return;
            }

            const analysis = calculateQuickAnalysis(examType, totalScore);
            displayResults(analysis, false);
        }

        function analyzeDetailed() {
            const examType = document.getElementById('examTypeDetailed').value;
            const listening = parseFloat(document.getElementById('listeningScore').value) || 0;
            const reading = parseFloat(document.getElementById('readingScore').value) || 0;
            const writing = parseFloat(document.getElementById('writingScore').value) || 0;

            if (listening === 0 && reading === 0 && writing === 0) {
                alert('è¯·è‡³å°‘è¾“å…¥ä¸€é¡¹æˆç»©');
                return;
            }

            const totalScore = listening + reading + writing;

            if (totalScore > 710) {
                alert('æ€»åˆ†ä¸èƒ½è¶…è¿‡710åˆ†');
                return;
            }

            const analysis = calculateDetailedAnalysis(examType, {
                listening, reading, writing, total: totalScore
            });
            displayResults(analysis, true);
        }

        function calculateQuickAnalysis(examType, score) {
            const isCET4 = examType === 'cet4';
            
            // è®¡ç®—ç™¾åˆ†ä½ï¼ˆä½ è¶…è¶Šäº†X%çš„å¤§å­¦ç”Ÿï¼‰
            let percentile;
            if (isCET4) {
                // CET-4: ç›´æ¥è®¡ç®—åœ¨å…¨ä½“å¤§å­¦ç”Ÿä¸­çš„ä½ç½®
                if (score < 425) {
                    // æœªåŠæ ¼ï¼Œ0-50ç™¾åˆ†ä½ä¹‹é—´
                    percentile = (score - 220) / 205 * 50;
                } else if (score < 500) {
                    // åŠæ ¼åˆ°ä¸­ç­‰ï¼Œ50-70ç™¾åˆ†ä½
                    percentile = 50 + (score - 425) / 75 * 20;
                } else if (score < 550) {
                    // ä¸­ç­‰åä¸Šï¼Œ70-85ç™¾åˆ†ä½
                    percentile = 70 + (score - 500) / 50 * 15;
                } else {
                    // é«˜åˆ†ï¼Œ85-99ç™¾åˆ†ä½
                    percentile = 85 + (score - 550) / 160 * 14;
                }
            } else {
                // CET-6: éœ€è¦è€ƒè™‘é€‰æ‹©æ€§åå·®
                // CET-6è€ƒç”Ÿæœ¬èº«å·²æ˜¯ä¸ŠåŠéƒ¨åˆ†ï¼ˆ50%+ï¼‰
                // æ‰€ä»¥ç™¾åˆ†ä½ = 50% + (åœ¨CET-6è€ƒç”Ÿä¸­çš„ä½ç½® Ã— 50%)
                
                let positionInCET6Takers; // åœ¨CET-6è€ƒç”Ÿä¸­çš„ä½ç½®
                
                if (score < 425) {
                    // æœªåŠæ ¼ï¼Œåœ¨CET-6è€ƒç”Ÿä¸­å±äºå70%
                    positionInCET6Takers = (score - 220) / 205 * 30;
                } else if (score < 500) {
                    // åˆšåŠæ ¼ï¼Œåœ¨CET-6è€ƒç”Ÿä¸­30-50ç™¾åˆ†ä½
                    positionInCET6Takers = 30 + (score - 425) / 75 * 20;
                } else if (score < 550) {
                    // ä¸­ç­‰ï¼Œåœ¨CET-6è€ƒç”Ÿä¸­50-70ç™¾åˆ†ä½
                    positionInCET6Takers = 50 + (score - 500) / 50 * 20;
                } else if (score < 600) {
                    // è‰¯å¥½ï¼Œåœ¨CET-6è€ƒç”Ÿä¸­70-85ç™¾åˆ†ä½
                    positionInCET6Takers = 70 + (score - 550) / 50 * 15;
                } else {
                    // ä¼˜ç§€ï¼Œåœ¨CET-6è€ƒç”Ÿä¸­85-99ç™¾åˆ†ä½
                    positionInCET6Takers = 85 + (score - 600) / 110 * 14;
                }
                
                // æ˜ å°„åˆ°å…¨ä½“å¤§å­¦ç”Ÿï¼š50% + (åœ¨CET-6è€ƒç”Ÿä¸­çš„ä½ç½® Ã— 50%)
                percentile = 50 + (positionInCET6Takers * 0.5);
            }

            percentile = Math.min(99, Math.max(1, percentile));

            // ç¡®å®šç­‰çº§
            let level, levelName, levelClass;
            if (percentile >= 98) {
                level = 'ä¼ å¥‡çº§';
                levelName = 'Legendary';
                levelClass = 'legendary';
            } else if (percentile >= 95) {
                level = 'é’»çŸ³çº§';
                levelName = 'Diamond';
                levelClass = 'diamond';
            } else if (percentile >= 85) {
                level = 'é“‚é‡‘çº§';
                levelName = 'Platinum';
                levelClass = 'platinum';
            } else if (percentile >= 70) {
                level = 'é»„é‡‘çº§';
                levelName = 'Gold';
                levelClass = 'gold';
            } else if (percentile >= 50) {
                level = 'ç™½é“¶çº§';
                levelName = 'Silver';
                levelClass = 'silver';
            } else {
                level = 'é’é“œçº§';
                levelName = 'Bronze';
                levelClass = 'bronze';
            }

            // å¯¹åº”å›½é™…è€ƒè¯•
            let ielts, toefl, cefr;
            if (isCET4) {
                if (score >= 600) {
                    ielts = '5.5-6.0';
                    toefl = '70-80';
                    cefr = 'B1+';
                } else if (score >= 550) {
                    ielts = '5.0-5.5';
                    toefl = '65-75';
                    cefr = 'B1';
                } else if (score >= 500) {
                    ielts = '5.0';
                    toefl = '60-70';
                    cefr = 'B1';
                } else if (score >= 425) {
                    ielts = '4.5-5.0';
                    toefl = '50-60';
                    cefr = 'A2+/B1-';
                } else {
                    ielts = '4.0-4.5';
                    toefl = '40-50';
                    cefr = 'A2';
                }
            } else {
                if (score >= 600) {
                    ielts = '7.0+';
                    toefl = '100+';
                    cefr = 'B2+/C1-';
                } else if (score >= 550) {
                    ielts = '6.5-7.0';
                    toefl = '90-100';
                    cefr = 'B2+';
                } else if (score >= 500) {
                    ielts = '6.0-6.5';
                    toefl = '80-90';
                    cefr = 'B2';
                } else if (score >= 425) {
                    ielts = '5.5-6.0';
                    toefl = '70-80';
                    cefr = 'B1+/B2-';
                } else {
                    ielts = '5.0-5.5';
                    toefl = '60-70';
                    cefr = 'B1';
                }
            }

            return {
                percentile: Math.round(percentile),
                level, levelName, levelClass,
                ielts, toefl, cefr,
                examType: isCET4 ? 'CET-4' : 'CET-6',
                totalScore: score
            };
        }

        function calculateDetailedAnalysis(examType, scores) {
            const { listening, reading, writing, total } = scores;
            const isCET4 = examType === 'cet4';

            // å…ˆè®¡ç®—åŸºæœ¬åˆ†æ
            const basicAnalysis = calculateQuickAnalysis(examType, total);

            // è®¡ç®—å„é¡¹ç™¾åˆ†æ¯”
            const listeningPercent = (listening / 249) * 100;
            const readingPercent = (reading / 249) * 100;
            const writingPercent = (writing / 212) * 100;

            // ç¡®å®šä¼˜åŠ¿å’ŒåŠ£åŠ¿
            const skills = [
                { name: 'å¬åŠ›', score: listening, percent: listeningPercent },
                { name: 'é˜…è¯»', score: reading, percent: readingPercent },
                { name: 'å†™ä½œä¸ç¿»è¯‘', score: writing, percent: writingPercent }
            ];

            skills.sort((a, b) => b.percent - a.percent);

            const strengths = [];
            const weaknesses = [];
            const suggestions = [];

            // åˆ†æå¬åŠ›
            if (listeningPercent >= 70) {
                strengths.push('å¬åŠ›ç†è§£èƒ½åŠ›å¼ºï¼Œèƒ½å¤Ÿæ•æ‰å…³é”®ä¿¡æ¯');
            } else if (listeningPercent < 50) {
                weaknesses.push('å¬åŠ›æ˜¯ä¸»è¦çŸ­æ¿ï¼Œéœ€è¦é‡ç‚¹æå‡');
                suggestions.push({
                    title: 'å¬åŠ›æå‡å»ºè®®',
                    content: 'æ¯å¤©è¿›è¡Œ30åˆ†é’Ÿç²¾å¬è®­ç»ƒï¼Œä½¿ç”¨BBCã€VOAç­‰ææ–™ã€‚é‡ç‚¹è®­ç»ƒï¼š(1)å…³é”®è¯æ•æ‰èƒ½åŠ›ï¼›(2)åŒä¹‰æ›¿æ¢è¯†åˆ«ï¼›(3)ç¬”è®°è®°å½•æŠ€å·§ã€‚æ¨èä½¿ç”¨"å½±å­è·Ÿè¯»æ³•"æå‡è¯­éŸ³è¯†åˆ«é€Ÿåº¦ã€‚'
                });
            }

            // åˆ†æé˜…è¯»
            if (readingPercent >= 70) {
                strengths.push('é˜…è¯»ç†è§£æ‰å®ï¼Œèƒ½å¤Ÿå¿«é€ŸæŠŠæ¡æ–‡ç« ä¸»æ—¨');
            } else if (readingPercent < 50) {
                weaknesses.push('é˜…è¯»é€Ÿåº¦æˆ–ç†è§£æ·±åº¦éœ€è¦æé«˜');
                suggestions.push({
                    title: 'é˜…è¯»æå‡å»ºè®®',
                    content: 'é‡‡ç”¨"ç²¾è¯»+æ³›è¯»"ç»“åˆç­–ç•¥ã€‚ç²¾è¯»ï¼šæ¯å¤©1ç¯‡æ–‡ç« ï¼Œåˆ†æé•¿éš¾å¥å’Œé€»è¾‘ç»“æ„ã€‚æ³›è¯»ï¼šæ¯å‘¨é˜…è¯»3-5ç¯‡ï¼Œæå‡é€Ÿåº¦ã€‚é‡ç‚¹è®­ç»ƒæ®µè½ä¸»æ—¨æŠŠæ¡å’Œæ¨ç†é¢˜è§£é¢˜æŠ€å·§ã€‚'
                });
            }

            // åˆ†æå†™ä½œ
            if (writingPercent >= 70) {
                strengths.push('å†™ä½œä¸ç¿»è¯‘è¡¨è¾¾æµç•…ï¼Œé€»è¾‘æ¸…æ™°');
            } else if (writingPercent < 50) {
                weaknesses.push('å†™ä½œä¸ç¿»è¯‘éœ€è¦åŠ å¼ºç»ƒä¹ ');
                suggestions.push({
                    title: 'å†™ä½œæå‡å»ºè®®',
                    content: 'å»ºç«‹"å¥å‹åº“+æ¨¡æ¿åº“"ã€‚æ¯å‘¨ç»ƒä¹ 2-3ç¯‡ä½œæ–‡ï¼Œé‡ç‚¹ï¼š(1)å¼€å¤´ç»“å°¾å¥å‹ç§¯ç´¯ï¼›(2)é€»è¾‘è¿æ¥è¯ä½¿ç”¨ï¼›(3)é«˜çº§è¯æ±‡æ›¿æ¢ã€‚ç¿»è¯‘æ–¹é¢ï¼Œæ¯å¤©ç»ƒä¹ ä¸€æ®µä¸­è¯‘è‹±ï¼Œæ³¨æ„è¯­åºè°ƒæ•´ã€‚'
                });
            }

            // ç»¼åˆå»ºè®®
            if (total >= 550) {
                suggestions.push({
                    title: 'å†²åˆºé«˜åˆ†ç­–ç•¥',
                    content: 'ä½ å·²ç»å…·å¤‡è¾ƒå¼ºå®åŠ›ï¼Œç°åœ¨éœ€è¦ç²¾ç»†åŒ–æå‡ã€‚å»ºè®®ï¼š(1)é’ˆå¯¹é”™é¢˜è¿›è¡Œæ·±åº¦åˆ†æï¼›(2)æ¨¡æ‹ŸçœŸé¢˜é™æ—¶è®­ç»ƒï¼›(3)å¦‚æœ‰å‡ºå›½è®¡åˆ’ï¼Œå¯å‡†å¤‡é›…æ€/æ‰˜ç¦ï¼Œè¿›ä¸€æ­¥æå‡ã€‚'
                });
            } else if (total >= 425) {
                suggestions.push({
                    title: 'ç¨³å›ºæå‡è·¯å¾„',
                    content: 'ä½ å·²è¾¾åˆ°åŠæ ¼æ°´å¹³ï¼Œå»ºè®®ç³»ç»Ÿæ€§æå‡ã€‚æ¯å¤©ä¿æŒ2å°æ—¶å­¦ä¹ ï¼š1å°æ—¶è¾“å…¥ï¼ˆå¬åŠ›+é˜…è¯»ï¼‰ï¼Œ1å°æ—¶è¾“å‡ºï¼ˆå†™ä½œ+ç¿»è¯‘ï¼‰ã€‚é‡ç‚¹è¡¥è¶³çŸ­æ¿ç§‘ç›®ï¼ŒåŒæ—¶ä¿æŒä¼˜åŠ¿ç§‘ç›®ã€‚'
                });
            } else {
                suggestions.push({
                    title: 'åŸºç¡€å¤¯å®è®¡åˆ’',
                    content: 'å»ºè®®ä»åŸºç¡€æŠ“èµ·ï¼š(1)è¯æ±‡ï¼šæ¯å¤©èƒŒè¯µ50ä¸ªæ ¸å¿ƒè¯æ±‡ï¼›(2)è¯­æ³•ï¼šç³»ç»Ÿå¤ä¹ åŸºç¡€è¯­æ³•ï¼›(3)å¬åŠ›ï¼šä»æ…¢é€Ÿææ–™å¼€å§‹ï¼›(4)é˜…è¯»ï¼šé€‰æ‹©é€‚åˆéš¾åº¦çš„æ–‡ç« ã€‚å»ºè®®3-6ä¸ªæœˆç³»ç»Ÿå­¦ä¹ åå†æ¬¡æŒ‘æˆ˜ã€‚'
                });
            }

            // å¦‚æœæœ‰æ˜æ˜¾çš„ä¸å¹³è¡¡
            const maxPercent = Math.max(listeningPercent, readingPercent, writingPercent);
            const minPercent = Math.min(listeningPercent, readingPercent, writingPercent);
            if (maxPercent - minPercent > 30) {
                weaknesses.push('å„ç§‘ç›®å‘å±•ä¸å‡è¡¡ï¼Œéœ€è¦è¡¥è¶³çŸ­æ¿');
                suggestions.push({
                    title: 'å¹³è¡¡å‘å±•å»ºè®®',
                    content: 'ä½ çš„å„ç§‘å·®è·è¾ƒå¤§ã€‚å»ºè®®é‡‡ç”¨"2:1æ—¶é—´åˆ†é…æ³•"ï¼š60%æ—¶é—´è¡¥è¶³çŸ­æ¿ï¼Œ30%æ—¶é—´æå‡ä¼˜åŠ¿ï¼Œ10%æ—¶é—´ç»¼åˆè®­ç»ƒã€‚é¿å…"æœ¨æ¡¶æ•ˆåº”"å½±å“æ€»åˆ†ã€‚'
                });
            }

            return {
                ...basicAnalysis,
                scores,
                listeningPercent: Math.round(listeningPercent),
                readingPercent: Math.round(readingPercent),
                writingPercent: Math.round(writingPercent),
                strengths,
                weaknesses,
                suggestions
            };
        }

        function displayResults(analysis, isDetailed) {
            // æ˜¾ç¤ºç™¾åˆ†ä½
            document.getElementById('percentileValue').textContent = analysis.percentile + '%';
            
            // æ˜¾ç¤ºç­‰çº§å¾½ç« 
            const badge = document.getElementById('levelBadge');
            badge.textContent = `${analysis.level} ${analysis.levelName}`;
            badge.className = 'level-badge ' + analysis.levelClass;

            // è®¾ç½®ç™¾åˆ†ä½æ ‡è®°ä½ç½®
            const marker = document.getElementById('markerPosition');
            marker.style.left = analysis.percentile + '%';

            // å›½é™…å¯¹æ ‡
            const comparisonGrid = document.getElementById('comparisonGrid');
            comparisonGrid.innerHTML = `
                <div class="comparison-card">
                    <h3>é›…æ€ IELTS</h3>
                    <div class="score">${analysis.ielts}</div>
                    <div class="desc">å›½é™…è‹±è¯­è¯­è¨€æµ‹è¯•ç³»ç»Ÿ</div>
                </div>
                <div class="comparison-card">
                    <h3>æ‰˜ç¦ TOEFL</h3>
                    <div class="score">${analysis.toefl}</div>
                    <div class="desc">æ£€å®šéè‹±è¯­æ¯è¯­è€…çš„è‹±è¯­èƒ½åŠ›</div>
                </div>
                <div class="comparison-card">
                    <h3>CEFRç­‰çº§</h3>
                    <div class="score">${analysis.cefr}</div>
                    <div class="desc">æ¬§æ´²å…±åŒè¯­è¨€å‚è€ƒæ ‡å‡†</div>
                </div>
            `;

            // èƒ½åŠ›æ¦‚è§ˆ
            const infoGrid = document.getElementById('infoGrid');
            infoGrid.innerHTML = `
                <div class="info-item">
                    <div class="icon">ğŸ“</div>
                    <div class="value">${analysis.totalScore}</div>
                    <div class="label">${analysis.examType} æ€»åˆ†</div>
                </div>
                <div class="info-item">
                    <div class="icon">ğŸ“Š</div>
                    <div class="value">Top ${100 - analysis.percentile}%</div>
                    <div class="label">å…¨å›½æ’å</div>
                </div>
                <div class="info-item">
                    <div class="icon">ğŸ¯</div>
                    <div class="value">${analysis.level}</div>
                    <div class="label">èƒ½åŠ›ç­‰çº§</div>
                </div>
                <div class="info-item">
                    <div class="icon">ğŸŒ</div>
                    <div class="value">${analysis.cefr}</div>
                    <div class="label">å›½é™…ç­‰çº§</div>
                </div>
            `;

            // è¯¦ç»†åˆ†æéƒ¨åˆ†
            const detailedResults = document.getElementById('detailedResults');
            if (isDetailed) {
                detailedResults.classList.remove('hidden');

                // å•ç§‘åˆ†å¸ƒ
                const scoreDistribution = document.getElementById('scoreDistribution');
                scoreDistribution.innerHTML = `
                    <div class="distribution-bar">
                        <div class="distribution-label">å¬åŠ›</div>
                        <div class="distribution-fill-container">
                            <div class="distribution-fill" style="width: ${analysis.listeningPercent}%">
                                ${analysis.scores.listening}åˆ† (${analysis.listeningPercent}%)
                            </div>
                        </div>
                    </div>
                    <div class="distribution-bar">
                        <div class="distribution-label">é˜…è¯»</div>
                        <div class="distribution-fill-container">
                            <div class="distribution-fill" style="width: ${analysis.readingPercent}%">
                                ${analysis.scores.reading}åˆ† (${analysis.readingPercent}%)
                            </div>
                        </div>
                    </div>
                    <div class="distribution-bar">
                        <div class="distribution-label">å†™ä½œç¿»è¯‘</div>
                        <div class="distribution-fill-container">
                            <div class="distribution-fill" style="width: ${analysis.writingPercent}%">
                                ${analysis.scores.writing}åˆ† (${analysis.writingPercent}%)
                            </div>
                        </div>
                    </div>
                `;

                // é›·è¾¾å›¾
                createRadarChart(analysis);

                // ä¼˜åŠ¿åˆ—è¡¨
                const strengthList = document.getElementById('strengthList');
                strengthList.innerHTML = analysis.strengths.length > 0 
                    ? analysis.strengths.map(s => `<li>${s}</li>`).join('')
                    : '<li>ç»§ç»­åŠªåŠ›ï¼Œå‘å±•ä½ çš„ä¼˜åŠ¿ï¼</li>';

                // åŠ£åŠ¿åˆ—è¡¨
                const weaknessList = document.getElementById('weaknessList');
                weaknessList.innerHTML = analysis.weaknesses.length > 0
                    ? analysis.weaknesses.map(w => `<li>${w}</li>`).join('')
                    : '<li>å„æ–¹é¢å‘å±•å‡è¡¡ï¼Œç»§ç»­ä¿æŒï¼</li>';

                // å»ºè®®åˆ—è¡¨
                const suggestionsList = document.getElementById('suggestionsList');
                suggestionsList.innerHTML = analysis.suggestions.map(s => `
                    <div class="suggestion-item">
                        <h4>${s.title}</h4>
                        <p>${s.content}</p>
                    </div>
                `).join('');
            } else {
                detailedResults.classList.add('hidden');
            }

            // æ˜¾ç¤ºç»“æœåŒºåŸŸ
            document.getElementById('results').classList.add('show');
            
            // æ»šåŠ¨åˆ°ç»“æœ
            setTimeout(() => {
                document.getElementById('results').scrollIntoView({ 
                    behavior: 'smooth', 
                    block: 'start' 
                });
            }, 100);
        }

        function createRadarChart(analysis) {
            const ctx = document.getElementById('radarChart');
            
            // é”€æ¯æ—§å›¾è¡¨
            if (radarChartInstance) {
                radarChartInstance.destroy();
            }

            radarChartInstance = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: ['å¬åŠ›', 'é˜…è¯»', 'å†™ä½œä¸ç¿»è¯‘'],
                    datasets: [{
                        label: 'ä½ çš„æˆç»©',
                        data: [
                            analysis.listeningPercent,
                            analysis.readingPercent,
                            analysis.writingPercent
                        ],
                        backgroundColor: 'rgba(233, 69, 96, 0.2)',
                        borderColor: 'rgba(233, 69, 96, 1)',
                        borderWidth: 3,
                        pointBackgroundColor: 'rgba(233, 69, 96, 1)',
                        pointBorderColor: '#fff',
                        pointHoverBackgroundColor: '#fff',
                        pointHoverBorderColor: 'rgba(233, 69, 96, 1)',
                        pointRadius: 5,
                        pointHoverRadius: 7
                    }, {
                        label: 'åŠæ ¼çº¿',
                        data: [60, 60, 60],
                        backgroundColor: 'rgba(0, 217, 255, 0.1)',
                        borderColor: 'rgba(0, 217, 255, 0.8)',
                        borderWidth: 2,
                        borderDash: [5, 5],
                        pointRadius: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 100,
                            ticks: {
                                stepSize: 20,
                                font: {
                                    size: 12,
                                    family: "'Noto Sans SC', sans-serif"
                                }
                            },
                            pointLabels: {
                                font: {
                                    size: 14,
                                    family: "'Noto Sans SC', sans-serif",
                                    weight: 'bold'
                                }
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                font: {
                                    size: 13,
                                    family: "'Noto Sans SC', sans-serif"
                                }
                            }
                        }
                    }
                }
            });
        }

        function resetForm() {
            // æ¸…ç©ºè¡¨å•
            document.getElementById('totalScore').value = '';
            document.getElementById('listeningScore').value = '';
            document.getElementById('readingScore').value = '';
            document.getElementById('writingScore').value = '';
            
            // éšè—ç»“æœ
            document.getElementById('results').classList.remove('show');
            
            // æ»šåŠ¨åˆ°é¡¶éƒ¨
            window.scrollTo({ top: 0, behavior: 'smooth' });
        }
    </script>
</body>
</html>
